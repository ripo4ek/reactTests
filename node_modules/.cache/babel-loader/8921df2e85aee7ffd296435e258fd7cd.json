{"ast":null,"code":"import React from 'react';\nimport Joi from \"joi\";\n\nclass Form extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: {},\n      errors: {}\n    };\n\n    this.validate = () => {\n      const result = Joi.validate(this.state.data, this.schema, {\n        abortEarly: false\n      });\n      if (!result.error) return null;\n      const errors = {};\n\n      for (let item of result.error.details) {\n        errors[item.path[0]] = item.message;\n      }\n\n      return errors;\n    };\n\n    this.validateProperty = ({\n      name,\n      value\n    }) => {\n      const propObj = {\n        [name]: value\n      };\n      const schemaProperty = {\n        [name]: this.schema[name]\n      };\n      const error = Joi.validate(propObj, schemaProperty);\n      console.log(schemaProperty);\n      if (error) return null;\n      return error.details[0].message;\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const errors = this.validate();\n      this.setState({\n        errors: errors || {}\n      });\n      if (errors) return;\n      this.makeSubmit();\n    };\n\n    this.handleChange = ({\n      currentTarget: input\n    }) => {\n      const errors = { ...this.state.errors\n      };\n      const errorMessage = this.validateProperty(input);\n      if (errorMessage) errors[input.name] = errorMessage;else delete errors[input.name];\n      const newAccount = { ...this.state.data\n      };\n      newAccount[input.name] = input.value;\n      this.setState({\n        data: newAccount,\n        errors: errors\n      });\n    };\n  }\n\n}\n\nexport default Form;","map":{"version":3,"sources":["C:/vidly/vidly/src/components/form.jsx"],"names":["React","Joi","Form","Component","state","data","errors","validate","result","schema","abortEarly","error","item","details","path","message","validateProperty","name","value","propObj","schemaProperty","console","log","handleSubmit","e","preventDefault","setState","makeSubmit","handleChange","currentTarget","input","errorMessage","newAccount"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,KAAhB;;AACA,MAAMC,IAAN,SAAmBC,SAAnB,CAA6B;AAAA;AAAA;AAAA,SACzBC,KADyB,GACjB;AACJC,MAAAA,IAAI,EAAE,EADF;AAEJC,MAAAA,MAAM,EAAE;AAFJ,KADiB;;AAAA,SAKzBC,QALyB,GAKd,MAAM;AACb,YAAMC,MAAM,GAAGP,GAAG,CAACM,QAAJ,CAAa,KAAKH,KAAL,CAAWC,IAAxB,EAA6B,KAAKI,MAAlC,EAA0C;AAACC,QAAAA,UAAU,EAAE;AAAb,OAA1C,CAAf;AACA,UAAG,CAACF,MAAM,CAACG,KAAX,EAAkB,OAAO,IAAP;AAElB,YAAML,MAAM,GAAG,EAAf;;AACA,WAAI,IAAIM,IAAR,IAAgBJ,MAAM,CAACG,KAAP,CAAaE,OAA7B,EAAqC;AACjCP,QAAAA,MAAM,CAACM,IAAI,CAACE,IAAL,CAAU,CAAV,CAAD,CAAN,GAAuBF,IAAI,CAACG,OAA5B;AACH;;AACD,aAAOT,MAAP;AACH,KAdwB;;AAAA,SAezBU,gBAfyB,GAeN,CAAC;AAACC,MAAAA,IAAD;AAAOC,MAAAA;AAAP,KAAD,KAAiB;AAChC,YAAMC,OAAO,GAAG;AAAC,SAACF,IAAD,GAAOC;AAAR,OAAhB;AACA,YAAME,cAAc,GAAG;AAAC,SAACH,IAAD,GAAO,KAAKR,MAAL,CAAYQ,IAAZ;AAAR,OAAvB;AACA,YAAMN,KAAK,GAAGV,GAAG,CAACM,QAAJ,CAAaY,OAAb,EAAqBC,cAArB,CAAd;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYF,cAAZ;AACA,UAAGT,KAAH,EAAU,OAAO,IAAP;AACV,aAAOA,KAAK,CAACE,OAAN,CAAc,CAAd,EAAiBE,OAAxB;AACH,KAtBwB;;AAAA,SAuBzBQ,YAvByB,GAuBVC,CAAC,IAAE;AACdA,MAAAA,CAAC,CAACC,cAAF;AAEA,YAAMnB,MAAM,GAAG,KAAKC,QAAL,EAAf;AACA,WAAKmB,QAAL,CAAc;AAACpB,QAAAA,MAAM,EAAEA,MAAM,IAAI;AAAnB,OAAd;AACA,UAAGA,MAAH,EAAW;AAEX,WAAKqB,UAAL;AAEH,KAhCwB;;AAAA,SAiCzBC,YAjCyB,GAiCV,CAAC;AAACC,MAAAA,aAAa,EAAEC;AAAhB,KAAD,KAA0B;AACrC,YAAMxB,MAAM,GAAG,EAAC,GAAG,KAAKF,KAAL,CAAWE;AAAf,OAAf;AACA,YAAMyB,YAAY,GAAG,KAAKf,gBAAL,CAAsBc,KAAtB,CAArB;AAEA,UAAGC,YAAH,EAAiBzB,MAAM,CAACwB,KAAK,CAACb,IAAP,CAAN,GAAqBc,YAArB,CAAjB,KACK,OAAOzB,MAAM,CAACwB,KAAK,CAACb,IAAP,CAAb;AACL,YAAMe,UAAU,GAAG,EAAC,GAAG,KAAK5B,KAAL,CAAWC;AAAf,OAAnB;AACA2B,MAAAA,UAAU,CAACF,KAAK,CAACb,IAAP,CAAV,GAAyBa,KAAK,CAACZ,KAA/B;AAEA,WAAKQ,QAAL,CAAc;AAACrB,QAAAA,IAAI,EAAE2B,UAAP;AAAmB1B,QAAAA,MAAM,EAACA;AAA1B,OAAd;AACH,KA3CwB;AAAA;;AAAA;;AA8C7B,eAAeJ,IAAf","sourcesContent":["import React from 'react';\r\nimport Joi from \"joi\"\r\nclass Form extends Component {\r\n    state = {  \r\n        data: {},\r\n        errors: {}\r\n    }\r\n    validate = () => {\r\n        const result = Joi.validate(this.state.data,this.schema, {abortEarly: false})\r\n        if(!result.error) return null\r\n\r\n        const errors = {}\r\n        for(let item of result.error.details){\r\n            errors[item.path[0]] = item.message\r\n        }\r\n        return errors;\r\n    }\r\n    validateProperty = ({name, value})=>{\r\n        const propObj = {[name]:value}\r\n        const schemaProperty = {[name]:this.schema[name]}\r\n        const error = Joi.validate(propObj,schemaProperty)\r\n        console.log(schemaProperty);\r\n        if(error) return null;\r\n        return error.details[0].message;\r\n    }\r\n    handleSubmit = e=>{\r\n        e.preventDefault();\r\n\r\n        const errors = this.validate();\r\n        this.setState({errors: errors || {}})\r\n        if(errors) return;\r\n\r\n        this.makeSubmit();\r\n\r\n    }\r\n    handleChange = ({currentTarget: input})=>{\r\n        const errors = {...this.state.errors};\r\n        const errorMessage = this.validateProperty(input)\r\n        \r\n        if(errorMessage) errors[input.name] = errorMessage;\r\n        else delete errors[input.name]\r\n        const newAccount = {...this.state.data}\r\n        newAccount[input.name] = input.value\r\n        \r\n        this.setState({data: newAccount, errors:errors})\r\n    }\r\n}\r\n \r\nexport default Form;"]},"metadata":{},"sourceType":"module"}